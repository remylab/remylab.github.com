<!DOCTYPE html>
<html>

    <head>
        <meta charset='utf-8' />
        <title>And the winner is...</title>
        <script>
        var script = document.createElement("script"); script.type = "text/javascript";
        script.src = "https://sheltered-ridge-3647.herokuapp.com";
        document.getElementsByTagName('head')[0].appendChild(script);

        var a=["Ren√© Gravel", "PeeJay", "Louiss-Thomass", "Seub", "Francistaillon", "David 'Pas Propre' Lafrance", "Kodjo", "Martin", "Mariem", "Mister Youss", "Bassam", "Amine"];

        var meme = [10547364, 11619842, 17578852, 28026826, 33509823, 8014115, 1633977, 19096195, 1570716 , 10252940, 35521300, 22902114, 27616631, 13126156, 7486979, 30788823, 342101];
        var as = a.length; memes = meme.length;
        var winner;
        
        var onS = function() {
            document.getElementById('question').style.display = 'none';
            winner = a[Math.floor(Math.random()*as)]; 
            memeId = meme[Math.floor(Math.random()*memes)];
            request = document.getElementById('qF').value;  
            
            loadMeme();
            counter(3);
        }
        var counter = function(n) { 
            console.log("counter +" + n);   
            if (n == 0) {                                         
                document.getElementById('counter').style.display = 'none';
                document.getElementById('img').style.display = 'inline';
                document.getElementById('memeurl').style.display = 'inline';
                return;
            }
            document.getElementById('counter').innerHTML = (n+"");
            setTimeout(function(){    
                counter(n-1);  
            },1000);
        }
                  
        
        var imgflip_jsonp = function(data) {
            console.log("meme loaded");
            document.getElementById('img').src = data;
            document.getElementById('memeurl').value = data;
        }
        
        var loadMeme = function() {
        
            script = document.createElement("script");
            script.type = "text/javascript";
            script.src = "https://sheltered-ridge-3647.herokuapp.com/imgflip?template_id="+memeId+"&text0="+request+" ...&text1="+winner+" !!!";
            document.getElementsByTagName('head')[0].appendChild(script);
        }
        </script>
        
        
        <style>
        .center {
            text-align:center;
            margin-top:100px;
            margin-left: auto;
            margin-right: auto;
            width: 50%;
        }
        input, button, label{
            font-size:24px;
        }
        </style>
    </head>
    
    <body style="font-size:250%;">
        <div class="center" style="overflow:hidden;position:relative;width:50%;">
            <div id="question">
                <label>Your request :</label><br/>
                <input id="qF" type="text" size="50" value="Example : Who will take ticket VRAK-3710 ?"></input><br/>
                <button type="submit" onclick="onS();">Pick a winner !</button>
            </div>
            <span id="counter" style="font-size:80px;"></span>
            
            <p><span style="display:none;font-size:30px;float:left;color:red;" id="request"></span><p>

            <img id="img" style="display:none;" src=""/>
            <input id="memeurl" type="text" style="display:none;width:380px;" value="my dyno is asleep, please wait 2 seconds..."/>
        </div>
    </body>
</html>
